package models_test

import (
	"fmt"
	"testing"

	dz "github.com/DolkMd/go-dezero/domain/core/dezero"
	"github.com/DolkMd/go-dezero/domain/core/dezero/ly/models"
)

func TestMLP(t *testing.T) {
	mlp := models.NewMLP([]int{10, 3})
	x := dz.AsVariable([][]float64{
		{-0.17036279, -0.75091714},
		{-0.15886047, -0.01906173},
		{0.15359965, 0.12809038},
		{-0.9223507, 0.18129861},
		{0.49350116, 0.51044744},
		{-0.12524168, 0.41135693},
		{0.23121913, 0.1579168},
		{-0.52873564, -0.7283122},
		{0.00512668, 0.01933176},
		{0.31354076, 0.58076864},
		{-0.41539234, -0.43295404},
		{-0.74082303, -0.59471107},
		{-0.01586872, 0.5397668},
		{0.4326635, -0.5245973},
		{0.5026432, 0.4579845},
		{-0.28567183, 0.14419296},
		{-0.01549666, -0.78984797},
		{-0.07018702, -0.7065223},
		{-0.7831353, -0.5552469},
		{0.02211946, -0.2690924},
		{-0.74176145, 0.11086001},
		{-0.30477002, -0.4816796},
		{0.02032876, 0.08767407},
		{-0.65559965, -0.6454371},
		{0.6405069, 0.60344917},
		{0.6741878, 0.517659},
		{-0.1008854, -0.35598052},
		{-0.01749143, -0.3295361},
		{0.34195596, 0.07460645},
		{-0.00837021, -0.00547171},
	})
	expexted := dz.AsVariable([][]float64{
		{-0.4876293, 0.1325196, 0.41529033},
		{-0.35369408, 0.40186074, 0.21280867},
		{-0.1534916, 0.65276664, 0.02419684},
		{-0.67446584, 0.09670146, 0.45161125},
		{0.0812964, 0.9663623, -0.21846855},
		{-0.253905, 0.5843322, 0.07494485},
		{-0.10627495, 0.7103272, -0.01946722},
		{-0.651532, -0.02925393, 0.54653144},
		{-0.25589913, 0.5190735, 0.12481563},
		{0.00770383, 0.9036036, -0.1667557},
		{-0.5586418, 0.11190338, 0.4356136},
		{-0.7181938, -0.06557725, 0.58181447},
		{-0.17077368, 0.70028764, -0.01142924},
		{-0.1264882, 0.5805208, 0.08134437},
		{0.07761039, 0.95389044, -0.20904753},
		{-0.39124942, 0.38571906, 0.22442889},
		{-0.4132185, 0.20828462, 0.35712528},
		{-0.42879248, 0.20468824, 0.36050326},
		{-0.7286257, -0.06768624, 0.5847696},
		{-0.3014605, 0.42054933, 0.19932808},
		{-0.6152584, 0.1427072, 0.41372058},
		{-0.5128442, 0.15124126, 0.40384695},
		{-0.23439354, 0.554596, 0.09802267},
		{-0.6923171, -0.05186366, 0.56830686},
		{0.15598787, 1.0524665, -0.28919086},
		{0.15802936, 1.0397748, -0.28024024},
		{-0.38493013, 0.3118909, 0.28098348},
		{-0.33458087, 0.37305322, 0.23496565},
		{-0.06364698, 0.7436459, -0.04498982},
		{-0.26813933, 0.50113016, 0.1383209}})
	y := mlp.Apply(x).First()
	fmt.Println(y, expexted.Shape())

	// assert.Equal(t, expexted, y)
}
